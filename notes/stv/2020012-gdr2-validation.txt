#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2019, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#  
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#


## Validation of GDR2 Parquet files


## Through Zeppelin, run Spark notebooks to fetch the parquet files as dataframes

%pyspark
df = sqlContext.read.parquet("/hadoop/gaia/parquet/gdr2/gaia_source/*.parquet")
sqlContext.registerDataFrameAsTable(df, "gaia_source")
df.show()


|        solution_id|         designation|          source_id|random_index|ref_epoch|                ra|           ra_error|                dec|          dec_error|            parallax|     parallax_error|parallax_over_error|               pmra|         pmra_error|              pmdec|        pmdec_error|ra_dec_corr|ra_parallax_corr|ra_pmra_corr|ra_pmdec_corr|dec_parallax_corr|dec_pmra_corr|dec_pmdec_corr|parallax_pmra_corr|parallax_pmdec_corr|pmra_pmdec_corr|astrometric_n_obs_al|astrometric_n_obs_ac|astrometric_n_good_obs_al|astrometric_n_bad_obs_al|astrometric_gof_al|astrometric_chi2_al|astrometric_excess_noise|astrometric_excess_noise_sig|astrometric_params_solved|astrometric_primary_flag|astrometric_weight_al|astrometric_pseudo_colour|astrometric_pseudo_colour_error|mean_varpi_factor_al|astrometric_matched_observations|visibility_periods_used|astrometric_sigma5d_max|frame_rotator_object_type|matched_observations|duplicated_source|phot_g_n_obs|  phot_g_mean_flux|phot_g_mean_flux_error|phot_g_mean_flux_over_error|phot_g_mean_mag|phot_bp_n_obs| phot_bp_mean_flux|phot_bp_mean_flux_error|phot_bp_mean_flux_over_error|phot_bp_mean_mag|phot_rp_n_obs| phot_rp_mean_flux|phot_rp_mean_flux_error|phot_rp_mean_flux_over_error|phot_rp_mean_mag|phot_bp_rp_excess_factor|phot_proc_mode|    bp_rp|       bp_g|      g_rp|radial_velocity|radial_velocity_error|rv_nb_transits|rv_template_teff|rv_template_logg|rv_template_fe_h|phot_variable_flag|                 l|                  b|           ecl_lon|            ecl_lat|priam_flags|teff_val|teff_percentile_lower|teff_percentile_upper|a_g_val|a_g_percentile_lower|a_g_percentile_upper|e_bp_min_rp_val|e_bp_min_rp_percentile_lower|e_bp_min_rp_percentile_upper|flame_flags|radius_val|radius_percentile_lower|radius_percentile_upper|lum_val|lum_percentile_lower|lum_percentile_upper|
+-------------------+--------------------+-------------------+------------+---------+------------------+-------------------+-------------------+-------------------+--------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+------------------------+------------------+-------------------+------------------------+----------------------------+-------------------------+------------------------+---------------------+-------------------------+-------------------------------+--------------------+--------------------------------+-----------------------+-----------------------+-------------------------+--------------------+-----------------+------------+------------------+----------------------+---------------------------+---------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------+------------------+-----------------------+----------------------------+----------------+------------------------+--------------+---------+-----------+----------+---------------+---------------------+--------------+----------------+----------------+----------------+------------------+------------------+-------------------+------------------+-------------------+-----------+--------+---------------------+---------------------+-------+--------------------+--------------------+---------------+----------------------------+----------------------------+-----------+----------+-----------------------+-----------------------+-------+--------------------+--------------------+
|1635721458409799680|Gaia DR2 40396632...|4039663277372837248|  1270143177|   2015.5|272.35914406389435| 1.1691890448753557| -33.72515909225413|  1.387598489811204|                null|               null|               null|               null|               null|               null|               null|  0.7007307|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  45|                   0|                       45|                       0|         6.8665886|          136.69447|      2.3810179481014804|           10.73937950203594|                        3|                   false|          0.121278614|                     null|                           null|         -0.06313744|                             5.0|                      5|                8.64087|                        0|                   5|            false|          45| 723.5454247667351|    15.623115877345247|                  46.312492|      18.539701|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.37494853294766| -6.792232809619019| 271.9941281968707|-10.302207268368774|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396788...|4039678872339871744|   919792950|   2015.5|272.42255201678194| 0.6318927674074143|-33.536154797850315| 0.5887834937687664|    1.16909568111717| 0.7696924805050609|          1.5189127| 0.4399008681029102| 1.1975395112863265|-0.7210029192439716| 0.9873082769738464| 0.19817178|      0.22033155| -0.41532785|  -0.30487925|      -0.42803577|  -0.19998975|   -0.50422806|       -0.33601665|         0.28258333|     0.27717692|                 141|                   0|                      141|                       0|         22.976942|          973.39264|       3.789289757847816|           49.23072942950997|                       31|                   false|          0.058279175|       1.2014567064078447|            0.15153429123505355|          0.09278982|                            16.0|                     10|              1.1852902|                        0|                  16|            false|         141| 682.7109285889612|     5.529295846828202|                  123.47159|      18.602774|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.5678136450211| -6.749454002797185|272.05100277696266|-10.114120006908836|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396623...|4039662384016337024|   459896475|   2015.5|272.55983934950456| 0.6012074550396774| -33.67242865128191|  0.541021866090318|  1.2365248877968356| 0.5435004501205588|          2.2751129| 0.7864157162093454| 1.3053559242005122|-1.0519075021117192| 1.1048215615763826|  0.5883333|     -0.19806615| -0.29485965|   -0.3185756|      -0.32479763|  -0.24900481|   -0.37368715|       -0.09392075|         0.17731772|     0.61679703|                 115|                   0|                      114|                       1|          2.293369|          145.67819|      1.1325695183976598|          1.0045433149560774|                       31|                   false|           0.09068902|       1.5900923682266286|            0.14736188342646453|          0.24781318|                            13.0|                      9|              1.3882388|                        0|                  13|            false|         114| 311.7428469164821|    2.2814067969626577|                    136.645|      19.453875|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.50113019829723| -6.914563991854187|272.16472654737254|-10.252381442891005|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396716...|4039671626792835968|  1668099795|   2015.5|272.70972511174125|0.35195197506854375| -33.44725562785949| 0.3099181256359613|-0.03449162618892853|0.42596571385844906|       -0.080972776|0.25762743937051724| 0.6344736223349822| -1.874856250258059| 0.5688395874993478|0.007616217|      -0.1578195|-0.010571752|  -0.39928564|      -0.06931064|  -0.35648984|   -0.21747105|       -0.38050923|          0.4224751|     0.13029568|                  97|                   0|                       97|                       0|        0.99119675|          105.37935|     0.47914720592201304|          0.3714095302294511|                       31|                   false|           0.23471576|       1.3865537414795854|            0.09031785593195675|        -0.031712666|                            11.0|                      8|              0.5940321|                        0|                  12|            false|          97|492.29644778053864|    2.7648399874261926|                  178.05603|        18.9578|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.76047732833547| -6.918764371230492| 272.2958371480868|-10.029567451550934|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396754...|4039675440726136960|   834049897|   2015.5|272.60884308982247| 0.7285502046805841|-33.398744688057896|  0.657198236393979|                null|               null|               null|               null|               null|               null|               null| 0.23823304|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  70|                   0|                       70|                       0|        -2.4993691|          39.980392|                     0.0|                         0.0|                        3|                   false|           0.07276001|                     null|                           null|          0.17088944|                             8.0|                      6|               4.566735|                        0|                   8|            false|          68|194.48499415309368|    2.0973528888217188|                   92.72879|       19.96615|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             1|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|  358.763661127075| -6.821641958642761| 272.2112763928603| -9.979487099759996|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396660...|4039666026147249152|  1282254298|   2015.5|272.49062275901986| 0.2293488495839044|-33.586248769458436|0.20380081174717737|-0.05101265986904...|0.28351409607368766|        -0.17992988| 0.4500531048652676| 0.4239368756174547|  -4.56226239861253| 0.3643049668000721| 0.25422132|      0.22875807| -0.39916244|  -0.21098444|       -0.3620745|   -0.1825217|   -0.49822167|       -0.33141336|           0.386283|     0.29353234|                 133|                   0|                      133|                       0|       -0.23790938|          123.57869|                     0.0|                         0.0|                       31|                   false|           0.47618827|        1.483155420792266|            0.05835847865684791|          0.13622679|                            15.0|                      8|             0.42351517|                        0|                  16|            false|         133| 753.3521165677026|      2.20703192306954|                  341.34174|       18.49587|           11| 526.4265364024615|     31.986275779875047|                   16.457888|       18.548044|           11| 776.9000746317806|      57.94871758299868|                   13.406683|       17.536007|               1.7300364|             0|1.0120373|0.052173615|0.95986366|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.55031144846305| -6.823107663185582|272.10773576610404|-10.165188923002708|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396648...|4039664823555798144|  1587075915|   2015.5|272.34964486225806| 1.3554125371598935|-33.656776894709026| 1.1490247033326673|                null|               null|               null|               null|               null|               null|               null|  0.6247954|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  93|                   0|                       93|                       0|         19.319675|           671.0781|        5.34896619595195|          30.844277223362333|                        3|                   false|           0.02634961|                     null|                           null|           0.3905218|                            11.0|                      8|              5.1011643|                        0|                  11|            false|          92| 312.6097940549685|     4.048258166898601|                   77.22082|       19.45086|            5|511.55508576340605|      34.14715291928097|                     14.9809|       18.579157|            5|  590.071355566542|      57.92706553192042|                   10.186454|        17.83466|               3.5239666|             0|0.7444973| -0.8717022| 1.6161995|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.43186933254356|  -6.75294317129583| 271.9872510339323|-10.233703244620253|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396759...|4039675986122456576|  1470510802|   2015.5| 272.6428591082576|0.21228804155482028| -33.35332899056685| 0.2070313630134911| 0.07928664714464018| 0.2856491691557616|         0.27756652|-0.7072044413790569| 0.4127249699749712| -2.833925301747556|0.37522464647270765|-0.03541162|     0.047542352|  -0.2962823|  -0.06498471|       -0.4304069|  0.058540907|   -0.49461102|        -0.3721662|          0.4958069|    0.023201486|                 115|                   0|                      113|                       2|         -1.442932|            87.5701|                     0.0|                         0.0|                       31|                   false|           0.52346283|       1.5277780640690268|            0.05809462029592919|         -0.10092877|                            13.0|                      9|             0.38633254|                        0|                  13|            false|         113| 774.8420430060451|    2.1221728447269728|                   365.1173|      18.465332|            9| 402.8712945962652|     23.122877411487117|                   17.423061|       18.838472|            8|  729.547562178405|      47.05709524584998|                   15.503455|       17.604286|               1.4614835|             0|1.2341862| 0.37314034|0.86104584|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.81748473112157| -6.825302748911408| 272.2409650405946| -9.934604757759187|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396735...|4039673516582170752|   995599926|   2015.5| 272.5778922034954| 1.8321665101573148| -33.47124262716305| 1.5074565973531913|                null|               null|               null|               null|               null|               null|               null|0.044490762|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  43|                   0|                       43|                       0|       -0.89704263|          30.129238|                     0.0|        4.075242079270000...|                        3|                   false|          0.040112063|                     null|                           null|          0.13262258|                             5.0|                      4|              558.68555|                        0|                   5|            false|          43| 128.6994775132784|    1.9293075020349142|                    66.7076|      20.414423|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.68700265372115| -6.833026440665509|272.18370665156334|-10.051500854548149|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396774...|4039677463587633664|   497799963|   2015.5|272.21604684984385|0.11930485134488483|-33.605705901365134|0.10672495575024883| 0.45863482554969065| 0.1194583081060792|          3.8392878| 1.0087789046981417|0.23025187783891418|  2.552563208751182|0.19073534147183888| 0.25796807|     -0.04207544| -0.39288422|  -0.33845615|      -0.23171622|  -0.27181792|   -0.49942857|       -0.22974691|          0.1456819|     0.22220919|                 140|                   0|                      140|                       0|         1.2787968|          156.38536|                     0.0|                         0.0|                       31|                   false|            1.6399343|       1.5223841465392276|           0.025650997333146474|          0.01172689|                            16.0|                     11|             0.22950256|                        0|                  16|            false|         137| 1851.807159358065|    2.7749967344828557|                  667.31866|      17.519377|           11|1228.1668150455052|     111.15304373322539|                   11.049332|       17.628244|           11|2037.5314476307597|      48.93787577218791|                    41.63506|       16.489159|               1.7635196|             0|1.1390858|0.108867645| 1.0302181|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.4241486748294| -6.630783617625621| 271.8750759976787| -10.18084803697198|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396628...|4039662899409694464|   248899981|   2015.5|272.37949154040655| 0.4887479468314345| -33.77228777181408| 0.4372442411838991|  1.0871739102729223|  0.460774649076223|          2.3594482|-5.5226121110546265| 1.2571165563592774| 1.7534601287469676| 1.0656796791578154| 0.45937523|    0.0018638239|-0.083243996|  -0.17427692|       -0.2421197|  -0.22223175|    -0.1586994|        0.17432633|         0.21619178|      0.6007942|                 126|                   0|                      124|                       2|         1.3780105|          140.80287|      0.7213921714560644|          0.4498138257717034|                       31|                   false|           0.10518342|         1.49901447618627|            0.10426951711072768|           0.1958008|                            15.0|                      9|                1.30676|                        0|                  15|            false|         125| 275.4170877390895|    1.7415955714842688|                  158.14067|      19.588388|            0|              null|                   null|                        null|            null|            2| 545.4353787080692|      87.08313834699635|                   6.2633867|       17.920061|                    null|             0|     null|       null| 1.6683273|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.34116807600066| -6.829411829153616|272.01052214437874|-10.349612160126359|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396775...|4039677502319700736|   124449990|   2015.5| 272.2367608842276|  6.772013237717013| -33.60165536274265|  7.065447452515119|                null|               null|               null|               null|               null|               null|               null| 0.97556007|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  43|                   0|                       42|                       1|         1.7231814|          53.038975|      2.8734068917140356|          1.8065764895273728|                        3|                   false|          0.031435326|                     null|                           null|           0.3394795|                             5.0|                      5|              264.09613|                        0|                   5|            false|          42|131.89171967306484|     2.003984632297391|                  65.814735|      20.387821|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.4359698149437| -6.644056919162917| 271.8926667566174|-10.177068863724875|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396793...|4039679323380141184|    62224995|   2015.5|272.39802926941604| 0.5883209534876451| -33.48757992059834| 0.5558255483332126| -1.3123164765908897| 0.6884603733194365|         -1.9061612|-2.7322070294167085| 1.1712408614097387| -6.269892865840246| 0.9469400616399435|  0.3901828|      0.14658883| -0.47026864|  -0.48985144|      -0.37922707|  -0.27386135|    -0.5047277|       -0.43526632|         0.14729011|     0.47025442|                  96|                   0|                       95|                       1|         1.0520025|           104.1283|      0.7458398446919191|          0.4453981310690341|                       31|                   false|           0.11204415|       1.5271914914296205|            0.14139796492522844|          0.16240597|                            11.0|                      8|               1.231572|                        0|                  11|            false|          94| 298.5376552590062|     1.913931649421698|                  155.98135|      19.500868|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             0|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.6011904750797| -6.708480173860968|272.03107655554714|-10.065204729242675|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396710...|4039671008320519168|    31112497|   2015.5| 272.6781160515176|  8.896114635477502| -33.50103215593762|   6.47236028778327|                null|               null|               null|               null|               null|               null|               null|  0.9877823|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  44|                   0|                       44|                       0|         2.7398906|           67.58138|      2.6221134969109774|            3.09782687057132|                        3|                   false|           0.04268529|                     null|                           null|            0.417246|                             5.0|                      5|              52.145985|                        0|                   5|            false|          41|207.04294513606783|     4.985608259144057|                  41.528122|      19.898214|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.7001802064104| -6.920794974054466| 272.2680273585723|-10.082833655564912|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396636...|4039663689687352960|  1614501798|   2015.5|272.43646741905724| 1.6852227811848526|-33.672093990397165|  1.426601708389085|                null|               null|               null|               null|               null|               null|               null|  0.9523355|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  87|                   0|                       87|                       0|         3.0654569|           126.9606|      1.3822331139775066|           2.545905392037597|                        3|                   false|           0.14527304|                     null|                           null|          0.36780328|                            10.0|                      6|               5.944584|                        0|                  10|            false|          87| 414.5901090238109|     2.314535310000476|                  179.12456|      19.144318|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE| 358.4526553200263| -6.823868684766996| 272.0604102338968| -10.25023780415667|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396769...|4039676952559930112|  1004015317|   2015.5|272.31763144917494|0.30684508585971093| -33.59894575403023|0.29241433202773065|  0.5537424360711616| 0.3854673772956747|          1.4365481|-3.9322258538116914| 0.6209460621947198|-3.6485256040374754| 0.5107653441232451|0.111489214|      0.17875744| -0.43922698| -0.100612596|      -0.51702696|  0.013967653|     -0.543115|       -0.33431667|         0.41590852|      0.1415937|                 126|                   0|                      125|                       1|       -0.88600945|          106.17508|                     0.0|                         0.0|                       31|                   false|           0.27228433|       1.6092130468016554|            0.07674278465940458|         0.064878754|                            15.0|                      9|             0.58080256|                        0|                  15|            false|         123| 505.1106287143355|     1.971907297031671|                  256.15332|        18.9299|           11|451.40849057855195|      95.48645549151846|                    4.727461|       18.714964|           11|459.02474762207606|      25.18252720556652|                   18.227907|        18.10733|               1.8024433|             0|0.6076336| -0.2149353| 0.8225689|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.47048148028944| -6.702104726394556| 271.9611372731214|-10.175441250517549|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396765...|4039676505880388736|   868057325|   2015.5|272.28949542936243| 2.5663100128921057| -33.63625785768909|  2.395712203451997|                null|               null|               null|               null|               null|               null|               null|  0.9536999|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  80|                   0|                       78|                       2|          4.349272|          138.14944|       2.799111433539378|           6.179820425626885|                        3|                   false|           0.05372527|                     null|                           null|          0.48319653|                             9.0|                      7|               13.37855|                        0|                   9|            false|          77|248.52076280521632|    3.0401128957233317|                  81.747215|      19.699959|            2| 156.7979610662521|     28.614937918499848|                    5.479584|       19.863037|            4| 339.8958181060015|      66.90401941592935|                     5.08035|       18.433556|               1.9986007|             0|1.4294815| 0.16307831| 1.2664032|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.42622158333523| -6.699120811197867| 271.9367184703466| -10.21236781076375|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396676...|4039667606765659776|   434028662|   2015.5| 272.6230911629393| 6.5246361332323435|-33.650811792758304|  5.266929766162441|                null|               null|               null|               null|               null|               null|               null|  0.9721894|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  46|                   0|                       45|                       1|         1.9598705|          59.343605|      2.9341103307378242|          2.1524360004367717|                        3|                   false|          0.034873694|                     null|                           null|          0.57339346|                             6.0|                      5|              36.458694|                        0|                   6|            false|          45|  157.896736972406|    2.6632046665904285|                  59.288246|      20.192432|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             2|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|  358.545314551025|-6.9508281157688305|272.21861767266046|-10.231730381865866|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396769...|4039676952559916672|  1664866318|   2015.5|  272.324731021255|0.37261564736037095| -33.59530115798869| 0.3239297456746766| 0.14180889717720213|  0.315567173944316|         0.44937783| 0.8676751745550275| 0.7438154339015497| -7.447301886924575|  0.612782235411975|  0.6131131|     0.011117067| -0.45494658|   -0.4125865|      -0.19829422|  -0.38832623|   -0.49419215|       -0.12346789|         0.19149539|      0.5974189|                 113|                   0|                      111|                       2|       -0.84900975|           93.49805|                     0.0|        9.76005508936517E-16|                       31|                   false|             0.280022|       1.4980769100262834|            0.08367141095712655|          0.23793668|                            13.0|                      9|             0.80755955|                        0|                  14|            false|         111| 516.4025763601646|    2.0514740773392552|                  251.72269|      18.905895|           12|371.17358306125954|     31.480867400511347|                    11.79045|       18.927446|           11| 682.4042463785356|      49.92834693724486|                   13.667671|       17.676815|               2.0402257|             0|1.2506313|0.021551132| 1.2290802|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.47653154567706| -6.705590275526194|271.96720512237664| -10.17189393560867|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
|1635721458409799680|Gaia DR2 40396733...|4039673379143199232|   832433159|   2015.5| 272.5642778634873| 22.597599454972954|-33.491851246825725| 17.857355748722703|                null|               null|               null|               null|               null|               null|               null|-0.99641377|            null|        null|         null|             null|         null|          null|              null|               null|           null|                  45|                   0|                       45|                       0|       -0.85271096|           32.26644|                     0.0|                         0.0|                        3|                   false|           0.08815383|                     null|                           null|          -0.1159497|                             5.0|                      3|              1036.5027|                        0|                   5|            false|          45|220.11688327845684|    1.9891300197914656|                 110.659874|      19.831732|            0|              null|                   null|                        null|            null|            0|              null|                   null|                        null|            null|                    null|             0|     null|       null|      null|           null|                 null|             0|            null|            null|            null|     NOT_AVAILABLE|358.66330636627856|-6.8327258151055785|272.17179663529834|-10.071900302966517|       null|    null|                 null|                 null|   null|                null|                null|           null|                        null|                        null|       null|      null|                   null|                   null|   null|                null|                null|
+-------------------+--------------------+-------------------+------------+---------+------------------+-------------------+-------------------+-------------------+--------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+------------------------+------------------+-------------------+------------------------+----------------------------+-------------------------+------------------------+---------------------+-------------------------+-------------------------------+--------------------+--------------------------------+-----------------------+-----------------------+-------------------------+--------------------+-----------------+------------+------------------+----------------------+---------------------------+---------------+-------------+------------------+-----------------------+----------------------------+----------------+-------------+------------------+-----------------------+----------------------------+----------------+------------------------+--------------+---------+-----------+----------+---------------+---------------------+--------------+----------------+----------------+----------------+------------------+------------------+-------------------+------------------+-------------------+-----------+--------+---------------------+---------------------+-------+--------------------+--------------------+---------------+----------------------------+----------------------------+-----------+----------+-----------------------+-----------------------+-------+--------------------+--------------------+
only showing top 20 rows




## Print Schema

df.printSchema()

root
 |-- solution_id: long (nullable = true)
 |-- designation: string (nullable = true)
 |-- source_id: long (nullable = true)
 |-- random_index: long (nullable = true)
 |-- ref_epoch: double (nullable = true)
 |-- ra: double (nullable = true)
 |-- ra_error: double (nullable = true)
 |-- dec: double (nullable = true)
 |-- dec_error: double (nullable = true)
 |-- parallax: double (nullable = true)
 |-- parallax_error: double (nullable = true)
 |-- parallax_over_error: float (nullable = true)
 |-- pmra: double (nullable = true)
 |-- pmra_error: double (nullable = true)
 |-- pmdec: double (nullable = true)
 |-- pmdec_error: double (nullable = true)
 |-- ra_dec_corr: float (nullable = true)
 |-- ra_parallax_corr: float (nullable = true)
 |-- ra_pmra_corr: float (nullable = true)
 |-- ra_pmdec_corr: float (nullable = true)
 |-- dec_parallax_corr: float (nullable = true)
 |-- dec_pmra_corr: float (nullable = true)
 |-- dec_pmdec_corr: float (nullable = true)
 |-- parallax_pmra_corr: float (nullable = true)
 |-- parallax_pmdec_corr: float (nullable = true)
 |-- pmra_pmdec_corr: float (nullable = true)
 |-- astrometric_n_obs_al: integer (nullable = true)
 |-- astrometric_n_obs_ac: integer (nullable = true)
 |-- astrometric_n_good_obs_al: integer (nullable = true)
 |-- astrometric_n_bad_obs_al: integer (nullable = true)
 |-- astrometric_gof_al: float (nullable = true)
 |-- astrometric_chi2_al: float (nullable = true)
 |-- astrometric_excess_noise: double (nullable = true)
 |-- astrometric_excess_noise_sig: double (nullable = true)
 |-- astrometric_params_solved: short (nullable = true)
 |-- astrometric_primary_flag: boolean (nullable = true)
 |-- astrometric_weight_al: float (nullable = true)
 |-- astrometric_pseudo_colour: double (nullable = true)
 |-- astrometric_pseudo_colour_error: double (nullable = true)
 |-- mean_varpi_factor_al: float (nullable = true)
 |-- astrometric_matched_observations: double (nullable = true)
 |-- visibility_periods_used: short (nullable = true)
 |-- astrometric_sigma5d_max: float (nullable = true)
 |-- frame_rotator_object_type: integer (nullable = true)
 |-- matched_observations: short (nullable = true)
 |-- duplicated_source: boolean (nullable = true)
 |-- phot_g_n_obs: integer (nullable = true)
 |-- phot_g_mean_flux: double (nullable = true)
 |-- phot_g_mean_flux_error: double (nullable = true)
 |-- phot_g_mean_flux_over_error: float (nullable = true)
 |-- phot_g_mean_mag: float (nullable = true)
 |-- phot_bp_n_obs: integer (nullable = true)
 |-- phot_bp_mean_flux: double (nullable = true)
 |-- phot_bp_mean_flux_error: double (nullable = true)
 |-- phot_bp_mean_flux_over_error: float (nullable = true)
 |-- phot_bp_mean_mag: float (nullable = true)
 |-- phot_rp_n_obs: integer (nullable = true)
 |-- phot_rp_mean_flux: double (nullable = true)
 |-- phot_rp_mean_flux_error: double (nullable = true)
 |-- phot_rp_mean_flux_over_error: float (nullable = true)
 |-- phot_rp_mean_mag: float (nullable = true)
 |-- phot_bp_rp_excess_factor: float (nullable = true)
 |-- phot_proc_mode: short (nullable = true)
 |-- bp_rp: float (nullable = true)
 |-- bp_g: float (nullable = true)
 |-- g_rp: float (nullable = true)
 |-- radial_velocity: double (nullable = true)
 |-- radial_velocity_error: double (nullable = true)
 |-- rv_nb_transits: integer (nullable = true)
 |-- rv_template_teff: float (nullable = true)
 |-- rv_template_logg: float (nullable = true)
 |-- rv_template_fe_h: float (nullable = true)
 |-- phot_variable_flag: string (nullable = true)
 |-- l: double (nullable = true)
 |-- b: double (nullable = true)
 |-- ecl_lon: double (nullable = true)
 |-- ecl_lat: double (nullable = true)
 |-- priam_flags: long (nullable = true)
 |-- teff_val: float (nullable = true)
 |-- teff_percentile_lower: float (nullable = true)
 |-- teff_percentile_upper: float (nullable = true)
 |-- a_g_val: float (nullable = true)
 |-- a_g_percentile_lower: float (nullable = true)
 |-- a_g_percentile_upper: float (nullable = true)
 |-- e_bp_min_rp_val: float (nullable = true)
 |-- e_bp_min_rp_percentile_lower: float (nullable = true)
 |-- e_bp_min_rp_percentile_upper: float (nullable = true)
 |-- flame_flags: long (nullable = true)
 |-- radius_val: float (nullable = true)
 |-- radius_percentile_lower: float (nullable = true)
 |-- radius_percentile_upper: float (nullable = true)
 |-- lum_val: float (nullable = true)
 |-- lum_percentile_lower: float (nullable = true)
 |-- lum_percentile_upper: float (nullable = true)





##-------------------------------------
## Data integrity Tests
##-------------------------------------




## Test 1. Count rows


## [Zeppelin] Run a select count (*) on the Parquet files

%sql 
select count(*)
from gaia_source 

## Returns: 1692919135 
## Job completed after 22 seconds



## [Gaia TAP] Run a select count (*) on the GAIA webpage (https://gea.esac.esa.int/archive/)

   select count (*) from gaiadr2.gaia_source

## Returns: 1692919135
## Job completed after 5 minutes









## Test 2. Get sum of column "astrometric_n_obs_al"


## [Zeppelin] On the Parquet files 

%sql 
select sum(astrometric_n_obs_al)
from gaia_source

## Returns: 308349055985
## Job completed after 32 seconds



##  [Gaia TAP] https://gea.esac.esa.int/archive/

    select sum(astrometric_n_obs_al) from gaiadr2.gaia_source

## Returns: 308349055985
## Job completed after 5 minutes and 10 seconds








## Test 3. Get min/max of column "ra"


## [Zeppelin] On the Parquet files 

%sql 
select min(ra), max(ra)
from gaia_source

## Returns:
## min 3.8206218899556496e-7
## max 359.99999805124315

## Job completed after 2 minutes and 29 seconds



##  [Gaia TAP] https://gea.esac.esa.int/archive/

   select min(ra), max(ra) from gaiadr2.gaia_source

## Returns
## min 3.8206218899556496e-7
## max 359.99999805124315

## Job completed after 1 second


