{
  "paragraphs": [
    {
      "title": "Pyspark - Calculate Pi",
      "text": "%pyspark\n\nimport random\nfrom pyspark import SparkContext\ndef inside(p):\n    x, y = random.random(), random.random()\n    return x*x + y*y < 1\nNUM_SAMPLES = 1000000\ncount = sc.parallelize(range(0, NUM_SAMPLES)) \\\n             .filter(inside).count()\nprint(\"Pi is roughly %f\" % (4.0 * count / NUM_SAMPLES))\n\n\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:48+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Pi is roughly 3.139716\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271761_13535652",
      "id": "20191124-174450_1521456687",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:48+0000",
      "dateFinished": "2019-11-25T18:41:49+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "focus": true,
      "$$hashKey": "object:312"
    },
    {
      "title": "Pyspark - Read tgas parquet files",
      "text": "%pyspark\ndf = sqlContext.read.parquet(\"/hadoop/gaia/parquet/gdr1/tgas/*.parquet\")\nsqlContext.registerDataFrameAsTable(df, \"tgas\")\ndf.show()",
      "user": "admin",
      "dateUpdated": "2019-11-29T12:42:53+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\n| hip|  tycho2id|        solution_id|          source_id|random_index|ref_epoch|               ra|           ra_error|              dec|          dec_error|           parallax|     parallax_error|                pmra|        pmra_error|              pmdec|       pmdec_error|ra_dec_corr|ra_parallax_corr|ra_pmra_corr|ra_pmdec_corr|dec_parallax_corr|dec_pmra_corr|dec_pmdec_corr|parallax_pmra_corr|parallax_pmdec_corr|pmra_pmdec_corr|astrometric_n_obs_al|astrometric_n_obs_ac|astrometric_n_good_obs_al|astrometric_n_good_obs_ac|astrometric_n_bad_obs_al|astrometric_n_bad_obs_ac|astrometric_delta_q|astrometric_excess_noise|astrometric_excess_noise_sig|astrometric_primary_flag|astrometric_relegation_factor|astrometric_weight_al|astrometric_weight_ac|astrometric_priors_used|matched_observations|duplicated_source|scan_direction_strength_k1|scan_direction_strength_k2|scan_direction_strength_k3|scan_direction_strength_k4|scan_direction_mean_k1|scan_direction_mean_k2|scan_direction_mean_k3|scan_direction_mean_k4|phot_g_n_obs|   phot_g_mean_flux|phot_g_mean_flux_error|   phot_g_mean_mag|phot_variable_flag|                 l|                  b|          ecl_lon|            ecl_lat|\n+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\n|null|145-1189-1|1635378410781933568|3324652545098403584|     1065174|   2015.0| 97.2029885278314| 0.8210986304876189|7.449368763607799|  0.924462663492092| 1.2626817262520844| 0.4731823213382397|  0.5645590432199348|3.5405523668044063|-1.6855621968327779|3.2115917809641457| -0.8834598|     -0.26617745|  -0.9209703|   0.91665494|     -0.017413165|    0.8643595|   -0.89972454|         0.3579438|         -0.3206203|    -0.97354233|                  75|                  75|                       75|                       65|                       0|                      10|               null|      1.0288352606795348|          222.56042838171538|                    true|                    10.021549|           0.93997914|         2.1507154E-5|                      5|                  10|            false|                0.49521425|                0.43904713|                 0.6530198|                 0.8858745|           -101.465324|             36.513966|            -23.921446|            -42.891327|          74|  194734.4895851405|    106.95840332956907|12.301162872380058|     NOT_AVAILABLE|203.72424619963414|-1.5965929085714246|97.42403581619894|-15.804474788759219|\n|null| 732-288-1|1635378410781933568|3324709925861486208|      545675|   2015.0|97.37243251079283| 0.4077870731365008|7.951159972813053| 0.4431004437644876| 1.4807902986091461| 0.3399542171903084|   1.198440271647966|2.1691292413673735| 2.7700916661426134|1.8310746665166746| -0.7665787|     -0.16903156|  -0.8450539|   0.85803777|      -0.22833453|    0.7410946|   -0.80205536|        0.33200154|        -0.23006296|    -0.94646883|                  67|                  67|                       67|                       61|                       0|                       6|               null|      0.6009681354863526|           350.2928409548967|                    true|                    5.9098372|             2.641958|         3.9789094E-5|                      5|                   8|            false|                0.49230763|                 0.2845628|                 0.6342528|                 0.9267229|               -89.027|             32.884727|            -27.685621|             -43.34189|          67|  534043.4334855399|    1459.9638311727563|11.205828615295257|     NOT_AVAILABLE|203.35736585986425| -1.215187138526316|97.57081196513477| -15.29457765023086|\n|null| 732-238-1|1635378410781933568|3324745488188020608|      202979|   2015.0|96.69209686457408| 0.4561511508015649|7.984252803621084| 0.4889992008614555|0.29406579949379374|0.36376163129282424|  -1.434736209115244|2.4536647714666073|-2.0850790055278976|2.0601068366867583|-0.78943485|     -0.14257503|  -0.8464847|    0.8661735|       -0.2072151|   0.75612843|    -0.8174196|        0.33318716|        -0.21492937|    -0.94381875|                  70|                  70|                       70|                       66|                       0|                       4|               null|      0.6859221006682781|           513.5872394104525|                    true|                     6.722787|            1.9972208|         3.7857404E-5|                      5|                   8|            false|                0.48338026|                0.25813478|                  0.614246|                0.93346685|             -85.64784|             32.499035|            -28.816439|            -43.525394|          69|  693844.1832926064|      1344.37272805746|10.921615184295657|     NOT_AVAILABLE| 203.0151259310447|-1.7965751041142013|96.87146143767407| -15.29554378306164|\n|null|144-2487-1|1635378410781933568|3324793042065458816|      910417|   2015.0|94.43165021345801|0.38939782013849156|6.237140767943739|0.41848433548978287|  1.359232108856971|0.26906257114112053|  -4.429921738952996|1.8189884559064295|-3.9942679167083224|1.6081658806869363|  -0.771974|    -0.031744886|  -0.8379243|   0.79157925|      -0.12153713|   0.77843684|    -0.8466086|        0.25939497|        -0.23906437|    -0.93677807|                  90|                  90|                       90|                       86|                       0|                       4|               null|      0.5658396862230853|           265.9892267341885|                    true|                     5.574578|            3.0302005|         2.8140712E-5|                      5|                  11|            false|                 0.4024498|                0.24884224|                0.52956456|                0.90365547|             -67.24736|             28.713865|            -32.994095|            -43.762756|          90|  424875.4631666628|    472.23932087529124|11.454115936275715|     NOT_AVAILABLE|203.51293393092885|  -4.59591666176878|94.61034430462567|-17.131244650665344|\n|null|144-2834-1|1635378410781933568|3324819224186088064|      435724|   2015.0|94.52274489356176|0.38028190667747336|6.386528158932098|0.40232241819465125| 3.9795924467867865|0.24185736990362147|   23.72091070740205|1.8293041848264247| -32.44693707953712|1.5883307645374027|-0.82887834|     -0.07042223|  -0.8570338|    0.8427514|     -0.023391845|    0.8202358|   -0.88841826|        0.33615896|        -0.25295454|     -0.9328685|                  79|                  79|                       79|                       71|                       0|                       8|               null|     0.38611562357703977|           125.3951707495626|                    true|                     3.873561|             6.289387|          3.454028E-5|                      5|                  10|            false|                0.41818687|                 0.1969489|                 0.4874747|                  0.912647|             -53.38099|             25.741655|            -34.795258|            -42.729942|          75|  479918.9914709596|     938.0703978668473|11.321850223142402|     NOT_AVAILABLE|203.42317051656778| -4.445892912062807|94.69992650968184|-16.978995277118877|\n|null|144-1946-1|1635378410781933568|3324850869505103488|      177787|   2015.0|94.55166631951272| 0.4465993037407111|6.761205369661423| 0.6978260826844375| 0.6436054298951857| 0.7977808410302859| -1.0383783749521531| 1.356899674916438|-1.1344721777439992|1.4435096569831232|-0.10469186|      0.12184461| -0.48954132|   0.22605333|       -0.7079793|   0.22539264|   -0.47963786|       0.104264796|        -0.06957464|      -0.570004|                  62|                  62|                       62|                       60|                       0|                       2|               null|      1.2123458432516574|           519.5444484581808|                    true|                    11.792603|           0.59478366|         2.5323312E-5|                      5|                   7|            false|                 0.5720156|                 0.1983013|                0.61911774|                0.90631074|            -51.148556|            -22.683064|            -35.175632|             -41.46176|          60|  822136.8989182921|     551.6050659770794|10.737409712525508|     NOT_AVAILABLE|203.10483441398156| -4.244764890348353|94.71705768217186|-16.603576162778182|\n|null|144-2752-1|1635378410781933568|3324882652264579200|       86714|   2015.0|93.93722332137871| 0.4499580542618802|6.728179276406868| 0.5265739022336192|-0.4457739567816648|0.43079831505623395| -2.8768912616516826|2.4336731047668443| 0.6443487515883661| 2.223400448715992| -0.5990863|      0.06942992|  -0.7380502|   0.65488636|      -0.07083962|    0.7013815|    -0.8371393|        0.34600118|        -0.27216157|    -0.86607856|                  48|                  48|                       48|                       44|                       0|                       4|               null|      0.7400157024014319|          152.07532318407286|                    true|                     7.241653|            1.7769806|         2.8257668E-5|                      5|                   6|            false|                0.55885696|                0.14173527|                 0.5552708|                 0.9359486|            -46.609806|             -26.22959|             -38.56132|            -42.326195|          43|  539074.6819555243|       871.87427943579|11.195647725482127|     NOT_AVAILABLE| 202.8464220661031| -4.798896582931779|94.08159161742087|-16.655334825337594|\n|null| 144-944-1|1635378410781933568|3324924330625765760|     1141611|   2015.0|94.86934239422445|0.47209205788455966|6.636089742632013| 0.5143406606008167| 1.2656414001097525|0.23270868500434672| -3.6710739872082696|2.4173995651662814|-0.6936892282098953| 2.145138625769714| -0.9093506|     -0.27760828| -0.89650077|   0.89267755|       0.13186076|    0.8713558|    -0.9025994|        0.42068535|        -0.39044112|    -0.97774833|                  81|                  81|                       81|                       78|                       0|                       3|               null|     0.35900140113114865|           181.7458846706345|                    true|                    3.6203122|             7.417269|         3.1306816E-5|                      5|                   9|            false|                0.36562452|                0.56147605|                 0.4593919|                0.92184705|           -101.303894|             40.723354|             -25.95727|              -44.4403|          80|  453607.6289853876|     615.1147387092124| 11.38306918855525|     NOT_AVAILABLE|203.36393590707308| -4.024732338929261|95.05065237832288|-16.717860959498505|\n|null| 144-385-1|1635378410781933568|3324972949657042048|     1519837|   2015.0|95.30023107226307|  0.380024199607382|7.178214707966409| 0.4112642366969811| 0.6130401806415621| 0.2428117279030442|  2.4154911478845933| 1.934865366887255|-3.4549615289692057|1.6735736406439143|-0.85336435|     -0.17328076| -0.87761074|    0.8801561|      -0.06921209|   0.82321405|    -0.8706583|        0.34429416|        -0.26923466|    -0.95894396|                 107|                 107|                      106|                       99|                       1|                       8|               null|     0.43552542873917266|          223.64066310439534|                    true|                    4.3379726|             5.033367|          3.218275E-5|                      5|                  12|            false|                 0.4252388|                 0.3609364|                0.54508436|                0.91929936|             -87.96635|             36.624626|            -28.087221|             -43.68397|         107| 407206.50562894664|    429.49794585124954|11.500233294397814|     NOT_AVAILABLE|203.08454206333178| -3.392953584567485|95.47556890373272|-16.160379507981126|\n|null|144-1518-1|1635378410781933568|3325018682468793088|     1912279|   2015.0|94.44033587035354| 0.2647116411740977|7.264990183571789|0.30388273902971696| 7.8994295727195505|0.24847509873158355| -49.408154291168465|1.4473264404992217| -59.07002074745423|1.2392596831961924| -0.6555329|     -0.08049957|  -0.8541135|   0.81039137|      -0.33856776|   0.71369714|    -0.7762767|        0.22677068|        -0.19379744|    -0.94562507|                  56|                  56|                       56|                       55|                       0|                       1|               null|     0.25024179360634885|           90.12576646172653|                    true|                    2.6234257|            14.158455|         3.0653024E-5|                      5|                   7|            false|                0.54905003|                0.12141594|                 0.6674345|                0.92462045|            -77.433655|             10.614393|            -30.915285|             -43.38907|          56|  578141.3925287051|     381.2792952615875|11.119684903405387|     NOT_AVAILABLE|202.60684576472065| -4.105729722908017|94.58490017418941|-16.103648240914396|\n|null|731-3370-1|1635378410781933568|3325052492451391744|     1888849|   2015.0|94.68074054294831| 0.6309502834868131|7.507365112591284| 0.7314987021465852|0.47480668240660107| 0.9283976448732572|  3.4803935274583084|0.8149224752374603| -9.671591554995318|1.0663728628393176| -0.2718446|      0.36313924| 0.097896636|   0.34785342|       -0.6840638| -0.034468338|   -0.25211194|        0.25122717|         0.27327058|     0.11119068|                  52|                  52|                       52|                       51|                       0|                       1|               null|      1.9177854959124614|           6730.465916739916|                    true|                     18.61417|           0.26966867|         1.4937942E-5|                      5|                   6|            false|                 0.5196939|                0.08222231|                0.55805445|                 0.9501356|            -61.348804|             4.4780736|            -33.448616|             -42.22487|          49|1.073044658411441E7|    244510.48481481805| 7.948225571371928|     NOT_AVAILABLE|202.50465598632442|-3.7813974251569014|94.82446272213934|-15.853561071456326|\n|null|143-2157-1|1635378410781933568|3325087986062153088|       69856|   2015.0|93.26404847305817| 0.3781554995816988|6.942873361145457|0.43559464495205213|  1.396149143533257| 0.2577062360687618| -0.7568074714939266| 1.783201789181223| -5.441177512308763|1.5966905412025758|  -0.843198|     -0.14314072| -0.89009285|     0.891333|      -0.14103241|    0.8293999|    -0.8790488|         0.2891487|         -0.2185679|     -0.9518185|                  70|                  70|                       70|                       67|                       0|                       3|               null|     0.37054020841049984|          172.44100363309343|                    true|                    3.7279239|             6.828021|          3.061938E-5|                      5|                   8|            false|                0.47985357|                 0.2726468|                 0.6100104|                 0.9045966|             -83.67105|              32.23614|             -26.60855|            -42.085995|          69|  382764.0835872703|    277.11187339248653|11.567442115632229|     NOT_AVAILABLE|202.33991876746012|   -5.2870320420724|93.37868932153492|-16.458133584986577|\n|null| 143-325-1|1635378410781933568|3325118634948309120|     1031971|   2015.0| 93.6853126910258|0.35131063088974823|7.142724548122767| 0.3682847239301545| 0.7925857797463123|0.30796333434460715| -2.5198486676400216|1.6392613237172193| 0.1453723530932382|1.4133221243112004|-0.58104724|     0.106766135|  -0.8019103|      0.68558|       -0.3343199|    0.6685713|   -0.76141965|        0.13264227|        -0.15666369|     -0.9101675|                  49|                  49|                       49|                       49|                       0|                       0|               null|      0.4438343007870951|          105.89864660620269|                    true|                     4.416373|             4.483471|         2.5124371E-5|                      5|                   6|            false|                0.51566356|                 0.1522077|                0.65315884|                 0.9152561|             -60.51448|              -9.78121|            -36.011562|             -44.22141|          47| 1927260.5717901457|    1624.3826893543703| 9.812418972271796|     NOT_AVAILABLE| 202.3612406639612| -4.824122901801671|93.80903144922297|-16.247841428998644|\n|null|143-2212-1|1635378410781933568|3325156946056586624|     1403805|   2015.0| 92.9687907396395| 0.3422788762103698|7.176985356711868|0.37243835156734156|  7.415479910192346| 0.2914162573494341|-0.18212665416976118|1.6196213367569532|-21.771939015636907|1.4267628511576451|-0.65992355|      0.08416968|  -0.7735783|    0.7092157|      -0.30051556|    0.6759396|   -0.76813626|        0.18043475|         -0.1472293|     -0.9092665|                  54|                  54|                       52|                       53|                       2|                       1|               null|     0.48519938252169853|           259.2359723655972|                    true|                    4.8077297|            4.0067058|         2.8833483E-5|                      5|                   8|            false|                0.44411612|                 0.1920766|                0.55044436|                 0.9230398|             -71.10334|             28.581116|            -33.490196|             -44.27432|          52| 1489627.0533634492|     5558.266370218184|10.092076186333411|     NOT_AVAILABLE|201.99352019480276| -5.434422496861861|93.06790908968661|-16.230684647201688|\n|null|731-2679-1|1635378410781933568|3325220408493807360|     1899924|   2015.0|94.37305425185573| 0.4996336342430516|7.523234609670731| 0.5196046268162157| 1.4403137719844032| 0.2622695320603954|  1.1624462012804373|3.7693886791597193| -6.028376683788023|3.2559850191667468| -0.9060658|     -0.32763895| -0.90649974|    0.9038443|       0.24009241|   0.88572073|   -0.90964925|        0.50254214|          -0.460542|    -0.98483276|                  63|                  63|                       62|                       59|                       1|                       4|               null|     0.42020775037212427|          343.29666613279574|                    true|                    4.1936507|             5.064212|          3.309463E-5|                      5|                   8|            false|                0.29077455|                 0.4478554|                 0.3578557|                0.97301215|            -72.757484|               42.1932|            -36.425564|              44.69664|          72|  690454.4133031989|    1941.3415500431022|10.926932539046417|     NOT_AVAILABLE| 202.3469010390707| -4.043184549917971|94.50699290165122|-15.847655544819945|\n|null|731-2559-1|1635378410781933568|3325255043110062080|     1698924|   2015.0|94.63693765894077| 0.3880255008616761|7.836076607541631| 0.4106948982260747| 0.7390706602284131| 0.2723520311385546|  -2.945749186655098|2.0789713792778555|-1.5401029610466443|  1.80156994844566|-0.79982847|     -0.04754718|  -0.8241188|    0.8136851|     -0.082584314|    0.7773701|     -0.847916|        0.32463446|        -0.23386118|     -0.9362484|                  72|                  72|                       72|                       65|                       0|                       7|               null|      0.5287656775794762|          231.01354755545398|                    true|                     5.221481|              3.52517|         3.0410936E-5|                      5|                   8|            false|                 0.3692137|                0.27000406|                0.44481513|                 0.9401197|            -59.210976|              35.50291|            -35.727528|             -43.82059|          72| 331438.28520140756|     216.4026512492406|11.723763380492848|     NOT_AVAILABLE|202.19343244478654|-3.6652761741749558|94.76793891060406|  -15.5264915566589|\n|null|730-3072-1|1635378410781933568|3325280572393897728|      401324|   2015.0|93.72506279129922| 0.5853831056268157|7.620392962479164|  0.608571145147715|0.41385151308115636|0.36075034360415376|   -9.08223887222769| 2.731366083533451|  4.948450188963157|2.3587642281907355| -0.8325997|     -0.05539863|  -0.8725271|   0.85749245|      -0.16994305|   0.80997485|   -0.85905796|        0.23191138|        -0.18282288|     -0.9548213|                  98|                  98|                       98|                       91|                       0|                       7|               null|      0.9814247587687337|           599.9611034535313|                    true|                     9.564446|            1.0212107|          3.326191E-5|                      5|                  11|            false|                0.40113574|                0.32205975|                 0.5493878|                   0.91347|            -80.451706|              33.17572|            -30.543589|             -44.15794|          96|  346414.2502690981|     282.1718309011927|11.675780691173426|     NOT_AVAILABLE| 201.9573738404042| -4.563920499090119|93.83673839102143|-15.769289644642681|\n|null|730-2794-1|1635378410781933568|3325305964240545024|     1332550|   2015.0|93.81235167947963| 0.3430979947606009|7.899828518771204| 0.3983800990072072|  9.893074898046402| 0.3214119956253915|  11.212916705836646|1.5437843014622397| 13.877634439087831|1.3631537432730327| -0.6695651|     0.022861792|  -0.6047493|    0.5873298|       -0.4885334|    0.4864607|    -0.5639423|         0.1471853|         -0.1027421|    -0.93604386|                  61|                  61|                       59|                       60|                       2|                       1|               null|      0.5761399309481104|            395.675569640607|                    true|                     5.672817|            2.7096183|         2.0669444E-5|                      5|                   8|            false|                 0.5312338|                 0.6585292|                 0.5957727|                0.95965797|            -120.88964|             41.083252|            -24.431372|              43.25792|          67| 1815846.7142850081|    2480.7762120195607| 9.877072102538001|     NOT_AVAILABLE|201.75127559541306| -4.355725761089732|93.91863747559789|-15.487608974107744|\n|null|731-2933-1|1635378410781933568|3325335616694770816|      584772|   2015.0|94.01986601347079| 0.2290367137332313|8.141815546115529| 0.2953742894701604| 1.7724398795371377| 0.2753162817954013| -1.0787719301918208|0.9049683799323316| -3.180322501486486|0.8603696641258155|-0.51729643|      0.07186219|  -0.4635902|   0.41740718|       -0.5739662|   0.34610185|    -0.4719288|        0.12230089|       -0.068460636|    -0.86612177|                  69|                  69|                       69|                       68|                       0|                       1|               null|      0.4502891776482449|          200.86671144653116|                    true|                     4.477331|             4.282012|          2.448114E-5|                      5|                   9|            false|                 0.5322991|                 0.5012508|                 0.5837273|                0.96191615|           -110.209175|              41.77504|            -25.811083|              44.21676|          73|  1704107.401678639|    2591.4774370259215| 9.946027656885787|     NOT_AVAILABLE|201.63464770003782| -4.060340151953006|94.12458255631776|-15.239928872914092|\n|null| 732-886-1|1635378410781933568|3325392928740606720|     1674678|   2015.0|96.17253306241597|0.48462118228338086|7.766034768567088| 0.5465779101185164| 0.9054976643324829|0.34285939676086363|   5.243281913413511|2.6128406137120215|  8.200724747208158|2.3375055583841764|-0.80191153|     -0.15904057| -0.82798177|   0.80634797|     -0.028921233|    0.7820177|   -0.84113765|        0.36188427|        -0.32404923|    -0.95476985|                  88|                  88|                       87|                       80|                       1|                       8|               null|      0.8574261884047853|           910.3247755400103|                    true|                     8.370175|            1.3019437|          3.711215E-5|                      5|                  10|            false|                0.38079643|                0.38936776|                0.47846353|                0.92952347|            -84.223915|              38.62515|            -29.333904|             -43.73443|          87|    654766.63533472|    3583.2335857283533|10.984553710979776|     NOT_AVAILABLE| 202.9685658967809|-2.3536501276807797|96.34862259871927|-15.537318986857574|\n+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271761_714244690",
      "id": "20191124-174454_167777486",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-29T12:42:53+0000",
      "dateFinished": "2019-11-29T12:42:53+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:313"
    },
    {
      "text": "%pyspark\ndf2 = df.filter(df.random_index==1065174).collect()\nprint(df2)",
      "user": "gaiauser",
      "dateUpdated": "2019-12-02T10:21:54+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[Row(hip=None, tycho2id='145-1189-1', solution_id=1635378410781933568, source_id=3324652545098403584, random_index=1065174, ref_epoch=2015.0, ra=97.2029885278314, ra_error=0.8210986304876189, dec=7.449368763607799, dec_error=0.924462663492092, parallax=1.2626817262520844, parallax_error=0.4731823213382397, pmra=0.5645590432199348, pmra_error=3.5405523668044063, pmdec=-1.6855621968327779, pmdec_error=3.2115917809641457, ra_dec_corr=-0.8834598064422607, ra_parallax_corr=-0.2661774456501007, ra_pmra_corr=-0.9209703207015991, ra_pmdec_corr=0.9166549444198608, dec_parallax_corr=-0.017413165420293808, dec_pmra_corr=0.8643594980239868, dec_pmdec_corr=-0.899724543094635, parallax_pmra_corr=0.3579438030719757, parallax_pmdec_corr=-0.3206202983856201, pmra_pmdec_corr=-0.973542332649231, astrometric_n_obs_al=75, astrometric_n_obs_ac=75, astrometric_n_good_obs_al=75, astrometric_n_good_obs_ac=65, astrometric_n_bad_obs_al=0, astrometric_n_bad_obs_ac=10, astrometric_delta_q=None, astrometric_excess_noise=1.0288352606795348, astrometric_excess_noise_sig=222.56042838171538, astrometric_primary_flag=True, astrometric_relegation_factor=10.021549224853516, astrometric_weight_al=0.9399791359901428, astrometric_weight_ac=2.1507154087885283e-05, astrometric_priors_used=5, matched_observations=10, duplicated_source=False, scan_direction_strength_k1=0.4952142536640167, scan_direction_strength_k2=0.4390471279621124, scan_direction_strength_k3=0.6530197858810425, scan_direction_strength_k4=0.8858745098114014, scan_direction_mean_k1=-101.46532440185547, scan_direction_mean_k2=36.51396560668945, scan_direction_mean_k3=-23.921445846557617, scan_direction_mean_k4=-42.891326904296875, phot_g_n_obs=74, phot_g_mean_flux=194734.4895851405, phot_g_mean_flux_error=106.95840332956907, phot_g_mean_mag=12.301162872380058, phot_variable_flag='NOT_AVAILABLE', l=203.72424619963414, b=-1.5965929085714246, ecl_lon=97.42403581619894, ecl_lat=-15.804474788759219)]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271762_-419317220",
      "id": "20191124-175441_35014276",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-12-02T10:21:54+0000",
      "dateFinished": "2019-12-02T10:21:55+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:314"
    },
    {
      "text": "%sql \nselect source_id, random_index\nfrom tgas \nwhere random_index=1065174",
      "user": "admin",
      "dateUpdated": "2019-12-02T10:22:20+0000",
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "source_id": "string",
                      "random_index": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "source_id",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "random_index",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "source_id\trandom_index\n3324652545098403584\t1065174\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271762_-1083403123",
      "id": "20191124-175451_1696189896",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:52+0000",
      "dateFinished": "2019-11-25T18:41:53+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:315"
    },
    {
      "text": "%sql \nselect phot_g_n_obs, count(1) value \nfrom tgas \ngroup by phot_g_n_obs \norder by phot_g_n_obs",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:53+0000",
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "scatterChart",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "phot_g_n_obs": "string",
                      "value": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default",
                  "stacked": true
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [],
              "groups": [],
              "values": [
                {
                  "name": "value",
                  "index": 1,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "phot_g_n_obs\tvalue\n11\t17\n12\t11\n13\t13\n14\t8\n15\t15\n16\t25\n17\t29\n18\t32\n19\t20\n20\t15\n21\t26\n22\t31\n23\t41\n24\t83\n25\t125\n26\t261\n27\t294\n28\t201\n29\t244\n30\t301\n31\t406\n32\t699\n33\t1324\n34\t2509\n35\t3269\n36\t2231\n37\t681\n38\t905\n39\t1107\n40\t1649\n41\t2642\n42\t4926\n43\t8285\n44\t8608\n45\t4889\n46\t1495\n47\t2001\n48\t2756\n49\t3983\n50\t7124\n51\t12595\n52\t16770\n53\t15393\n54\t7620\n55\t2829\n56\t3617\n57\t5076\n58\t7995\n59\t13482\n60\t21387\n61\t25407\n62\t20674\n63\t9661\n64\t4180\n65\t5356\n66\t7616\n67\t11908\n68\t19357\n69\t27568\n70\t30136\n71\t21794\n72\t10042\n73\t4997\n74\t6680\n75\t9565\n76\t14800\n77\t22637\n78\t29494\n79\t29152\n80\t19933\n81\t8991\n82\t5645\n83\t7381\n84\t10810\n85\t16042\n86\t22979\n87\t27503\n88\t25124\n89\t16174\n90\t8261\n91\t6058\n92\t8255\n93\t11804\n94\t17124\n95\t22559\n96\t24982\n97\t21361\n98\t13625\n99\t7808\n100\t7087\n101\t9536\n102\t13352\n103\t18418\n104\t22914\n105\t23325\n106\t18659\n107\t12012\n108\t7833\n109\t8104\n110\t10944\n111\t14894\n112\t19797\n113\t22740\n114\t22191\n115\t17016\n116\t10978\n117\t7897\n118\t8854\n119\t11928\n120\t15984\n121\t20288\n122\t22162\n123\t20113\n124\t14990\n125\t9776\n126\t7770\n127\t9109\n128\t12348\n129\t16014\n130\t19188\n131\t20206\n132\t17686\n133\t12874\n134\t8495\n135\t7508\n136\t9066\n137\t12069\n138\t15345\n139\t17913\n140\t17543\n141\t14779\n142\t10436\n143\t7594\n144\t7202\n145\t8829\n146\t11371\n147\t14269\n148\t15428\n149\t14772\n150\t11976\n151\t8580\n152\t6587\n153\t6541\n154\t8444\n155\t10434\n156\t12362\n157\t13161\n158\t11986\n159\t9333\n160\t7060\n161\t5695\n162\t6008\n163\t7585\n164\t9273\n165\t10827\n166\t10862\n167\t9944\n168\t7588\n169\t5600\n170\t4815\n171\t5532\n172\t6843\n173\t8298\n174\t9348\n175\t8919\n176\t7598\n177\t5920\n178\t4597\n179\t4351\n180\t5077\n181\t6281\n182\t7216\n183\t7848\n184\t7403\n185\t6090\n186\t4779\n187\t3773\n188\t3975\n189\t4524\n190\t5540\n191\t6294\n192\t6544\n193\t6015\n194\t5005\n195\t3887\n196\t3314\n197\t3479\n198\t4186\n199\t4959\n200\t5449\n201\t5304\n202\t4776\n203\t3801\n204\t3015\n205\t2794\n206\t3018\n207\t3604\n208\t4149\n209\t4564\n210\t4492\n211\t3790\n212\t3141\n213\t2520\n214\t2463\n215\t2633\n216\t3099\n217\t3462\n218\t3715\n219\t3493\n220\t3130\n221\t2428\n222\t2060\n223\t2074\n224\t2222\n225\t2660\n226\t2927\n227\t2956\n228\t2800\n229\t2360\n230\t1867\n231\t1719\n232\t1716\n233\t1906\n234\t2184\n235\t2431\n236\t2426\n237\t2194\n238\t1871\n239\t1545\n240\t1378\n241\t1542\n242\t1668\n243\t1876\n244\t2049\n245\t1802\n246\t1711\n247\t1541\n248\t1281\n249\t1208\n250\t1271\n251\t1443\n252\t1643\n253\t1683\n254\t1575\n255\t1410\n256\t1211\n257\t1086\n258\t1028\n259\t1210\n260\t1367\n261\t1362\n262\t1458\n263\t1345\n264\t1169\n265\t977\n266\t925\n267\t939\n268\t1088\n269\t1150\n270\t1168\n271\t1129\n272\t1063\n273\t950\n274\t864\n275\t791\n276\t843\n277\t907\n278\t974\n279\t1004\n280\t941\n281\t888\n282\t814\n283\t665\n284\t678\n285\t737\n286\t800\n287\t792\n288\t853\n289\t839\n290\t741\n291\t657\n292\t603\n293\t605\n294\t608\n295\t656\n296\t679\n297\t728\n298\t703\n299\t638\n300\t563\n301\t512\n302\t495\n303\t536\n304\t640\n305\t617\n306\t645\n307\t552\n308\t509\n309\t504\n310\t450\n311\t471\n312\t441\n313\t547\n314\t527\n315\t536\n316\t465\n317\t434\n318\t404\n319\t390\n320\t414\n321\t422\n322\t450\n323\t420\n324\t424\n325\t380\n326\t359\n327\t341\n328\t330\n329\t371\n330\t379\n331\t385\n332\t366\n333\t370\n334\t311\n335\t302\n336\t317\n337\t325\n338\t335\n339\t340\n340\t360\n341\t323\n342\t320\n343\t309\n344\t265\n345\t266\n346\t271\n347\t279\n348\t265\n349\t306\n350\t289\n351\t275\n352\t249\n353\t241\n354\t211\n355\t259\n356\t227\n357\t251\n358\t229\n359\t241\n360\t217\n361\t206\n362\t195\n363\t200\n364\t188\n365\t219\n366\t225\n367\t201\n368\t193\n369\t221\n370\t197\n371\t153\n372\t176\n373\t176\n374\t187\n375\t191\n376\t186\n377\t142\n378\t167\n379\t143\n380\t134\n381\t150\n382\t155\n383\t154\n384\t164\n385\t151\n386\t150\n387\t125\n388\t119\n389\t136\n390\t128\n391\t134\n392\t125\n393\t143\n394\t140\n395\t120\n396\t109\n397\t117\n398\t126\n399\t109\n400\t126\n401\t118\n402\t120\n403\t109\n404\t120\n405\t111\n406\t115\n407\t102\n408\t90\n409\t102\n410\t83\n411\t119\n412\t105\n413\t87\n414\t83\n415\t91\n416\t83\n417\t69\n418\t109\n419\t83\n420\t82\n421\t87\n422\t92\n423\t86\n424\t76\n425\t77\n426\t71\n427\t78\n428\t78\n429\t72\n430\t68\n431\t72\n432\t70\n433\t70\n434\t82\n435\t67\n436\t75\n437\t66\n438\t62\n439\t65\n440\t76\n441\t54\n442\t71\n443\t51\n444\t63\n445\t61\n446\t53\n447\t53\n448\t40\n449\t50\n450\t52\n451\t62\n452\t52\n453\t65\n454\t46\n455\t64\n456\t46\n457\t43\n458\t48\n459\t58\n460\t45\n461\t49\n462\t41\n463\t52\n464\t53\n465\t49\n466\t41\n467\t44\n468\t33\n469\t41\n470\t35\n471\t39\n472\t37\n473\t30\n474\t36\n475\t37\n476\t25\n477\t32\n478\t29\n479\t29\n480\t37\n481\t33\n482\t26\n483\t22\n484\t31\n485\t23\n486\t24\n487\t29\n488\t23\n489\t26\n490\t25\n491\t28\n492\t18\n493\t25\n494\t23\n495\t23\n496\t22\n497\t23\n498\t19\n499\t25\n500\t28\n501\t16\n502\t26\n503\t14\n504\t19\n505\t21\n506\t19\n507\t24\n508\t14\n509\t15\n510\t21\n511\t8\n512\t17\n513\t21\n514\t18\n515\t19\n516\t20\n517\t14\n518\t20\n519\t18\n520\t19\n521\t14\n522\t21\n523\t23\n524\t12\n525\t17\n526\t14\n527\t12\n528\t19\n529\t11\n530\t14\n531\t11\n532\t16\n533\t25\n534\t15\n535\t13\n536\t4\n537\t12\n538\t16\n539\t17\n540\t13\n541\t8\n542\t14\n543\t12\n544\t7\n545\t9\n546\t7\n547\t19\n548\t9\n549\t14\n550\t10\n551\t14\n552\t8\n553\t8\n554\t6\n555\t6\n556\t7\n557\t7\n558\t11\n559\t12\n560\t9\n561\t12\n562\t17\n563\t11\n564\t11\n565\t6\n566\t8\n567\t9\n568\t9\n569\t5\n570\t7\n571\t9\n572\t8\n573\t7\n574\t9\n575\t9\n576\t10\n577\t9\n578\t6\n579\t5\n580\t6\n581\t4\n582\t8\n583\t11\n584\t6\n585\t3\n586\t6\n587\t8\n588\t8\n589\t6\n590\t4\n591\t5\n592\t4\n593\t6\n594\t4\n595\t3\n596\t8\n597\t9\n598\t6\n599\t5\n600\t6\n601\t3\n602\t4\n603\t2\n604\t7\n605\t2\n606\t3\n607\t5\n608\t9\n609\t9\n610\t3\n611\t6\n612\t2\n613\t4\n614\t2\n615\t3\n616\t1\n617\t5\n618\t5\n619\t6\n620\t2\n621\t1\n622\t6\n623\t3\n624\t1\n625\t3\n626\t2\n627\t4\n628\t2\n629\t4\n630\t4\n631\t4\n632\t1\n633\t6\n634\t3\n635\t3\n636\t2\n637\t5\n638\t2\n639\t6\n640\t7\n641\t2\n642\t1\n643\t5\n644\t8\n645\t4\n646\t2\n647\t1\n648\t6\n649\t2\n650\t6\n651\t2\n652\t3\n653\t1\n654\t2\n655\t3\n656\t1\n657\t2\n658\t2\n659\t1\n660\t2\n661\t3\n662\t3\n663\t5\n664\t4\n665\t3\n666\t4\n667\t2\n668\t3\n669\t1\n670\t4\n671\t1\n672\t7\n673\t2\n674\t1\n675\t3\n676\t1\n677\t2\n678\t1\n679\t5\n681\t3\n682\t4\n683\t1\n687\t1\n688\t1\n689\t2\n690\t1\n692\t1\n693\t1\n695\t1\n696\t1\n697\t1\n698\t2\n699\t1\n700\t5\n701\t1\n702\t4\n703\t2\n704\t1\n705\t1\n706\t1\n707\t3\n708\t1\n709\t3\n711\t2\n713\t1\n714\t4\n715\t1\n716\t2\n717\t2\n719\t1\n723\t1\n724\t2\n725\t1\n727\t1\n728\t1\n729\t1\n730\t4\n731\t2\n733\t1\n734\t3\n737\t1\n738\t1\n739\t1\n741\t4\n742\t1\n743\t1\n744\t3\n745\t3\n746\t2\n747\t1\n748\t1\n749\t1\n751\t2\n752\t1\n753\t2\n754\t1\n756\t3\n757\t2\n758\t1\n759\t1\n760\t3\n764\t1\n765\t1\n766\t2\n767\t1\n768\t1\n771\t1\n772\t1\n773\t1\n775\t1\n776\t1\n778\t2\n779\t2\n780\t1\n781\t1\n782\t1\n785\t1\n786\t1\n787\t1\n788\t2\n789\t1\n790\t1\n791\t2\n792\t3\n793\t3\n795\t1\n796\t1\n797\t1\n798\t3\n799\t2\n801\t3\n802\t2\n803\t2\n804\t2\n805\t2\n806\t2\n807\t1\n813\t1\n815\t1\n816\t2\n817\t1\n818\t1\n819\t2\n820\t1\n821\t1\n822\t1\n825\t3\n826\t1\n827\t1\n828\t2\n829\t1\n830\t2\n831\t1\n832\t1\n833\t2\n840\t1\n841\t1\n842\t1\n843\t1\n845\t1\n848\t1\n849\t2\n852\t1\n853\t1\n854\t1\n856\t1\n857\t1\n858\t1\n859\t2\n860\t1\n867\t1\n868\t1\n870\t1\n871\t1\n872\t1\n873\t1\n875\t1\n876\t2\n877\t1\n878\t1\n883\t1\n884\t2\n886\t1\n888\t1\n890\t1\n892\t1\n894\t2\n896\t1\n898\t2\n899\t2\n900\t1\n905\t1\n906\t1\n909\t1\n910\t2\n911\t1\n913\t1\n914\t2\n916\t1\n922\t1\n925\t1\n927\t2\n930\t1\n933\t1\n934\t2\n936\t1\n937\t2\n939\t1\n941\t2\n942\t1\n943\t1\n945\t1\n958\t1\n959\t2\n962\t1\n964\t3\n968\t1\n970\t1\n973\t1\n976\t1\n979\t1\n980\t1\n983\t1\n987\t1\n989\t1\n994\t1\n996\t1\n1001\t2\n1002\t1\n1003\t3\n1006\t1\n1007\t1\n1013\t1\n1018\t1\n1020\t1\n1023\t1\n1024\t2\n1025\t1\n1028\t2\n1036\t2\n1038\t1\n1043\t1\n1046\t1\n1047\t1\n1050\t1\n1055\t1\n1057\t2\n1061\t1\n1062\t1\n1069\t1\n1070\t1\n1071\t1\n1072\t1\n1073\t1\n1077\t1\n1078\t2\n1085\t1\n1092\t1\n1094\t1\n1097\t1\n1099\t1\n1100\t1\n1102\t1\n1104\t1\n1111\t2\n1113\t1\n1114\t1\n1115\t1\n1122\t1\n1123\t1\n1126\t1\n1131\t1\n1134\t1\n1141\t1\n1151\t1\n1172\t1\n1175\t2\n1190\t1\n1194\t1\n1198\t2\n1205\t1\n1206\t2\n1213\t2\n1222\t1\n1226\t1\n1235\t1\n1240\t1\n1251\t1\n1260\t1\n1262\t1\n1267\t1\n1280\t1\n1293\t1\n1297\t1\n1331\t1\n1348\t1\n1357\t1\n1383\t1\n1388\t1\n1390\t1\n1402\t1\n1408\t1\n1412\t1\n1431\t1\n1437\t1\n1474\t1\n1499\t1\n1501\t1\n1512\t1\n1519\t1\n1538\t1\n1592\t2\n1619\t1\n1633\t2\n1657\t1\n1684\t1\n1691\t1\n1706\t1\n1716\t1\n1776\t1\n1856\t1\n1866\t1\n"
          },
          {
            "type": "TEXT",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271763_-1371540694",
      "id": "20191124-175649_1110829952",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:53+0000",
      "dateFinished": "2019-11-25T18:41:55+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:316"
    },
    {
      "title": "Spark (Scala)- Read tgas parquet files",
      "text": "%spark\nimport spark.implicits._\n\n// Read file as RDD \n//val txt = sc.textFile(\"hdfs://stv-aglais-master:9000/hadoop/gaia/ascii/tgas/TgasSourceHeaderSchema\")\n\nval newDataDF = sqlContext.read.parquet(\"/hadoop/gaia/parquet/gdr1/tgas/*.parquet\")\n//val newDataDF2 = sqlContext.read.parquet(\"/hadoop/gaia/parquet/gdr1/tgas/\")\n\n// show contents\nnewDataDF.show()",
      "user": "admin",
      "dateUpdated": "2019-11-29T12:43:04+0000",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\n| hip|  tycho2id|        solution_id|          source_id|random_index|ref_epoch|               ra|           ra_error|              dec|          dec_error|           parallax|     parallax_error|                pmra|        pmra_error|              pmdec|       pmdec_error|ra_dec_corr|ra_parallax_corr|ra_pmra_corr|ra_pmdec_corr|dec_parallax_corr|dec_pmra_corr|dec_pmdec_corr|parallax_pmra_corr|parallax_pmdec_corr|pmra_pmdec_corr|astrometric_n_obs_al|astrometric_n_obs_ac|astrometric_n_good_obs_al|astrometric_n_good_obs_ac|astrometric_n_bad_obs_al|astrometric_n_bad_obs_ac|astrometric_delta_q|astrometric_excess_noise|astrometric_excess_noise_sig|astrometric_primary_flag|astrometric_relegation_factor|astrometric_weight_al|astrometric_weight_ac|astrometric_priors_used|matched_observations|duplicated_source|scan_direction_strength_k1|scan_direction_strength_k2|scan_direction_strength_k3|scan_direction_strength_k4|scan_direction_mean_k1|scan_direction_mean_k2|scan_direction_mean_k3|scan_direction_mean_k4|phot_g_n_obs|   phot_g_mean_flux|phot_g_mean_flux_error|   phot_g_mean_mag|phot_variable_flag|                 l|                  b|          ecl_lon|            ecl_lat|\n+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\n|null|145-1189-1|1635378410781933568|3324652545098403584|     1065174|   2015.0| 97.2029885278314| 0.8210986304876189|7.449368763607799|  0.924462663492092| 1.2626817262520844| 0.4731823213382397|  0.5645590432199348|3.5405523668044063|-1.6855621968327779|3.2115917809641457| -0.8834598|     -0.26617745|  -0.9209703|   0.91665494|     -0.017413165|    0.8643595|   -0.89972454|         0.3579438|         -0.3206203|    -0.97354233|                  75|                  75|                       75|                       65|                       0|                      10|               null|      1.0288352606795348|          222.56042838171538|                    true|                    10.021549|           0.93997914|         2.1507154E-5|                      5|                  10|            false|                0.49521425|                0.43904713|                 0.6530198|                 0.8858745|           -101.465324|             36.513966|            -23.921446|            -42.891327|          74|  194734.4895851405|    106.95840332956907|12.301162872380058|     NOT_AVAILABLE|203.72424619963414|-1.5965929085714246|97.42403581619894|-15.804474788759219|\n|null| 732-288-1|1635378410781933568|3324709925861486208|      545675|   2015.0|97.37243251079283| 0.4077870731365008|7.951159972813053| 0.4431004437644876| 1.4807902986091461| 0.3399542171903084|   1.198440271647966|2.1691292413673735| 2.7700916661426134|1.8310746665166746| -0.7665787|     -0.16903156|  -0.8450539|   0.85803777|      -0.22833453|    0.7410946|   -0.80205536|        0.33200154|        -0.23006296|    -0.94646883|                  67|                  67|                       67|                       61|                       0|                       6|               null|      0.6009681354863526|           350.2928409548967|                    true|                    5.9098372|             2.641958|         3.9789094E-5|                      5|                   8|            false|                0.49230763|                 0.2845628|                 0.6342528|                 0.9267229|               -89.027|             32.884727|            -27.685621|             -43.34189|          67|  534043.4334855399|    1459.9638311727563|11.205828615295257|     NOT_AVAILABLE|203.35736585986425| -1.215187138526316|97.57081196513477| -15.29457765023086|\n|null| 732-238-1|1635378410781933568|3324745488188020608|      202979|   2015.0|96.69209686457408| 0.4561511508015649|7.984252803621084| 0.4889992008614555|0.29406579949379374|0.36376163129282424|  -1.434736209115244|2.4536647714666073|-2.0850790055278976|2.0601068366867583|-0.78943485|     -0.14257503|  -0.8464847|    0.8661735|       -0.2072151|   0.75612843|    -0.8174196|        0.33318716|        -0.21492937|    -0.94381875|                  70|                  70|                       70|                       66|                       0|                       4|               null|      0.6859221006682781|           513.5872394104525|                    true|                     6.722787|            1.9972208|         3.7857404E-5|                      5|                   8|            false|                0.48338026|                0.25813478|                  0.614246|                0.93346685|             -85.64784|             32.499035|            -28.816439|            -43.525394|          69|  693844.1832926064|      1344.37272805746|10.921615184295657|     NOT_AVAILABLE| 203.0151259310447|-1.7965751041142013|96.87146143767407| -15.29554378306164|\n|null|144-2487-1|1635378410781933568|3324793042065458816|      910417|   2015.0|94.43165021345801|0.38939782013849156|6.237140767943739|0.41848433548978287|  1.359232108856971|0.26906257114112053|  -4.429921738952996|1.8189884559064295|-3.9942679167083224|1.6081658806869363|  -0.771974|    -0.031744886|  -0.8379243|   0.79157925|      -0.12153713|   0.77843684|    -0.8466086|        0.25939497|        -0.23906437|    -0.93677807|                  90|                  90|                       90|                       86|                       0|                       4|               null|      0.5658396862230853|           265.9892267341885|                    true|                     5.574578|            3.0302005|         2.8140712E-5|                      5|                  11|            false|                 0.4024498|                0.24884224|                0.52956456|                0.90365547|             -67.24736|             28.713865|            -32.994095|            -43.762756|          90|  424875.4631666628|    472.23932087529124|11.454115936275715|     NOT_AVAILABLE|203.51293393092885|  -4.59591666176878|94.61034430462567|-17.131244650665344|\n|null|144-2834-1|1635378410781933568|3324819224186088064|      435724|   2015.0|94.52274489356176|0.38028190667747336|6.386528158932098|0.40232241819465125| 3.9795924467867865|0.24185736990362147|   23.72091070740205|1.8293041848264247| -32.44693707953712|1.5883307645374027|-0.82887834|     -0.07042223|  -0.8570338|    0.8427514|     -0.023391845|    0.8202358|   -0.88841826|        0.33615896|        -0.25295454|     -0.9328685|                  79|                  79|                       79|                       71|                       0|                       8|               null|     0.38611562357703977|           125.3951707495626|                    true|                     3.873561|             6.289387|          3.454028E-5|                      5|                  10|            false|                0.41818687|                 0.1969489|                 0.4874747|                  0.912647|             -53.38099|             25.741655|            -34.795258|            -42.729942|          75|  479918.9914709596|     938.0703978668473|11.321850223142402|     NOT_AVAILABLE|203.42317051656778| -4.445892912062807|94.69992650968184|-16.978995277118877|\n|null|144-1946-1|1635378410781933568|3324850869505103488|      177787|   2015.0|94.55166631951272| 0.4465993037407111|6.761205369661423| 0.6978260826844375| 0.6436054298951857| 0.7977808410302859| -1.0383783749521531| 1.356899674916438|-1.1344721777439992|1.4435096569831232|-0.10469186|      0.12184461| -0.48954132|   0.22605333|       -0.7079793|   0.22539264|   -0.47963786|       0.104264796|        -0.06957464|      -0.570004|                  62|                  62|                       62|                       60|                       0|                       2|               null|      1.2123458432516574|           519.5444484581808|                    true|                    11.792603|           0.59478366|         2.5323312E-5|                      5|                   7|            false|                 0.5720156|                 0.1983013|                0.61911774|                0.90631074|            -51.148556|            -22.683064|            -35.175632|             -41.46176|          60|  822136.8989182921|     551.6050659770794|10.737409712525508|     NOT_AVAILABLE|203.10483441398156| -4.244764890348353|94.71705768217186|-16.603576162778182|\n|null|144-2752-1|1635378410781933568|3324882652264579200|       86714|   2015.0|93.93722332137871| 0.4499580542618802|6.728179276406868| 0.5265739022336192|-0.4457739567816648|0.43079831505623395| -2.8768912616516826|2.4336731047668443| 0.6443487515883661| 2.223400448715992| -0.5990863|      0.06942992|  -0.7380502|   0.65488636|      -0.07083962|    0.7013815|    -0.8371393|        0.34600118|        -0.27216157|    -0.86607856|                  48|                  48|                       48|                       44|                       0|                       4|               null|      0.7400157024014319|          152.07532318407286|                    true|                     7.241653|            1.7769806|         2.8257668E-5|                      5|                   6|            false|                0.55885696|                0.14173527|                 0.5552708|                 0.9359486|            -46.609806|             -26.22959|             -38.56132|            -42.326195|          43|  539074.6819555243|       871.87427943579|11.195647725482127|     NOT_AVAILABLE| 202.8464220661031| -4.798896582931779|94.08159161742087|-16.655334825337594|\n|null| 144-944-1|1635378410781933568|3324924330625765760|     1141611|   2015.0|94.86934239422445|0.47209205788455966|6.636089742632013| 0.5143406606008167| 1.2656414001097525|0.23270868500434672| -3.6710739872082696|2.4173995651662814|-0.6936892282098953| 2.145138625769714| -0.9093506|     -0.27760828| -0.89650077|   0.89267755|       0.13186076|    0.8713558|    -0.9025994|        0.42068535|        -0.39044112|    -0.97774833|                  81|                  81|                       81|                       78|                       0|                       3|               null|     0.35900140113114865|           181.7458846706345|                    true|                    3.6203122|             7.417269|         3.1306816E-5|                      5|                   9|            false|                0.36562452|                0.56147605|                 0.4593919|                0.92184705|           -101.303894|             40.723354|             -25.95727|              -44.4403|          80|  453607.6289853876|     615.1147387092124| 11.38306918855525|     NOT_AVAILABLE|203.36393590707308| -4.024732338929261|95.05065237832288|-16.717860959498505|\n|null| 144-385-1|1635378410781933568|3324972949657042048|     1519837|   2015.0|95.30023107226307|  0.380024199607382|7.178214707966409| 0.4112642366969811| 0.6130401806415621| 0.2428117279030442|  2.4154911478845933| 1.934865366887255|-3.4549615289692057|1.6735736406439143|-0.85336435|     -0.17328076| -0.87761074|    0.8801561|      -0.06921209|   0.82321405|    -0.8706583|        0.34429416|        -0.26923466|    -0.95894396|                 107|                 107|                      106|                       99|                       1|                       8|               null|     0.43552542873917266|          223.64066310439534|                    true|                    4.3379726|             5.033367|          3.218275E-5|                      5|                  12|            false|                 0.4252388|                 0.3609364|                0.54508436|                0.91929936|             -87.96635|             36.624626|            -28.087221|             -43.68397|         107| 407206.50562894664|    429.49794585124954|11.500233294397814|     NOT_AVAILABLE|203.08454206333178| -3.392953584567485|95.47556890373272|-16.160379507981126|\n|null|144-1518-1|1635378410781933568|3325018682468793088|     1912279|   2015.0|94.44033587035354| 0.2647116411740977|7.264990183571789|0.30388273902971696| 7.8994295727195505|0.24847509873158355| -49.408154291168465|1.4473264404992217| -59.07002074745423|1.2392596831961924| -0.6555329|     -0.08049957|  -0.8541135|   0.81039137|      -0.33856776|   0.71369714|    -0.7762767|        0.22677068|        -0.19379744|    -0.94562507|                  56|                  56|                       56|                       55|                       0|                       1|               null|     0.25024179360634885|           90.12576646172653|                    true|                    2.6234257|            14.158455|         3.0653024E-5|                      5|                   7|            false|                0.54905003|                0.12141594|                 0.6674345|                0.92462045|            -77.433655|             10.614393|            -30.915285|             -43.38907|          56|  578141.3925287051|     381.2792952615875|11.119684903405387|     NOT_AVAILABLE|202.60684576472065| -4.105729722908017|94.58490017418941|-16.103648240914396|\n|null|731-3370-1|1635378410781933568|3325052492451391744|     1888849|   2015.0|94.68074054294831| 0.6309502834868131|7.507365112591284| 0.7314987021465852|0.47480668240660107| 0.9283976448732572|  3.4803935274583084|0.8149224752374603| -9.671591554995318|1.0663728628393176| -0.2718446|      0.36313924| 0.097896636|   0.34785342|       -0.6840638| -0.034468338|   -0.25211194|        0.25122717|         0.27327058|     0.11119068|                  52|                  52|                       52|                       51|                       0|                       1|               null|      1.9177854959124614|           6730.465916739916|                    true|                     18.61417|           0.26966867|         1.4937942E-5|                      5|                   6|            false|                 0.5196939|                0.08222231|                0.55805445|                 0.9501356|            -61.348804|             4.4780736|            -33.448616|             -42.22487|          49|1.073044658411441E7|    244510.48481481805| 7.948225571371928|     NOT_AVAILABLE|202.50465598632442|-3.7813974251569014|94.82446272213934|-15.853561071456326|\n|null|143-2157-1|1635378410781933568|3325087986062153088|       69856|   2015.0|93.26404847305817| 0.3781554995816988|6.942873361145457|0.43559464495205213|  1.396149143533257| 0.2577062360687618| -0.7568074714939266| 1.783201789181223| -5.441177512308763|1.5966905412025758|  -0.843198|     -0.14314072| -0.89009285|     0.891333|      -0.14103241|    0.8293999|    -0.8790488|         0.2891487|         -0.2185679|     -0.9518185|                  70|                  70|                       70|                       67|                       0|                       3|               null|     0.37054020841049984|          172.44100363309343|                    true|                    3.7279239|             6.828021|          3.061938E-5|                      5|                   8|            false|                0.47985357|                 0.2726468|                 0.6100104|                 0.9045966|             -83.67105|              32.23614|             -26.60855|            -42.085995|          69|  382764.0835872703|    277.11187339248653|11.567442115632229|     NOT_AVAILABLE|202.33991876746012|   -5.2870320420724|93.37868932153492|-16.458133584986577|\n|null| 143-325-1|1635378410781933568|3325118634948309120|     1031971|   2015.0| 93.6853126910258|0.35131063088974823|7.142724548122767| 0.3682847239301545| 0.7925857797463123|0.30796333434460715| -2.5198486676400216|1.6392613237172193| 0.1453723530932382|1.4133221243112004|-0.58104724|     0.106766135|  -0.8019103|      0.68558|       -0.3343199|    0.6685713|   -0.76141965|        0.13264227|        -0.15666369|     -0.9101675|                  49|                  49|                       49|                       49|                       0|                       0|               null|      0.4438343007870951|          105.89864660620269|                    true|                     4.416373|             4.483471|         2.5124371E-5|                      5|                   6|            false|                0.51566356|                 0.1522077|                0.65315884|                 0.9152561|             -60.51448|              -9.78121|            -36.011562|             -44.22141|          47| 1927260.5717901457|    1624.3826893543703| 9.812418972271796|     NOT_AVAILABLE| 202.3612406639612| -4.824122901801671|93.80903144922297|-16.247841428998644|\n|null|143-2212-1|1635378410781933568|3325156946056586624|     1403805|   2015.0| 92.9687907396395| 0.3422788762103698|7.176985356711868|0.37243835156734156|  7.415479910192346| 0.2914162573494341|-0.18212665416976118|1.6196213367569532|-21.771939015636907|1.4267628511576451|-0.65992355|      0.08416968|  -0.7735783|    0.7092157|      -0.30051556|    0.6759396|   -0.76813626|        0.18043475|         -0.1472293|     -0.9092665|                  54|                  54|                       52|                       53|                       2|                       1|               null|     0.48519938252169853|           259.2359723655972|                    true|                    4.8077297|            4.0067058|         2.8833483E-5|                      5|                   8|            false|                0.44411612|                 0.1920766|                0.55044436|                 0.9230398|             -71.10334|             28.581116|            -33.490196|             -44.27432|          52| 1489627.0533634492|     5558.266370218184|10.092076186333411|     NOT_AVAILABLE|201.99352019480276| -5.434422496861861|93.06790908968661|-16.230684647201688|\n|null|731-2679-1|1635378410781933568|3325220408493807360|     1899924|   2015.0|94.37305425185573| 0.4996336342430516|7.523234609670731| 0.5196046268162157| 1.4403137719844032| 0.2622695320603954|  1.1624462012804373|3.7693886791597193| -6.028376683788023|3.2559850191667468| -0.9060658|     -0.32763895| -0.90649974|    0.9038443|       0.24009241|   0.88572073|   -0.90964925|        0.50254214|          -0.460542|    -0.98483276|                  63|                  63|                       62|                       59|                       1|                       4|               null|     0.42020775037212427|          343.29666613279574|                    true|                    4.1936507|             5.064212|          3.309463E-5|                      5|                   8|            false|                0.29077455|                 0.4478554|                 0.3578557|                0.97301215|            -72.757484|               42.1932|            -36.425564|              44.69664|          72|  690454.4133031989|    1941.3415500431022|10.926932539046417|     NOT_AVAILABLE| 202.3469010390707| -4.043184549917971|94.50699290165122|-15.847655544819945|\n|null|731-2559-1|1635378410781933568|3325255043110062080|     1698924|   2015.0|94.63693765894077| 0.3880255008616761|7.836076607541631| 0.4106948982260747| 0.7390706602284131| 0.2723520311385546|  -2.945749186655098|2.0789713792778555|-1.5401029610466443|  1.80156994844566|-0.79982847|     -0.04754718|  -0.8241188|    0.8136851|     -0.082584314|    0.7773701|     -0.847916|        0.32463446|        -0.23386118|     -0.9362484|                  72|                  72|                       72|                       65|                       0|                       7|               null|      0.5287656775794762|          231.01354755545398|                    true|                     5.221481|              3.52517|         3.0410936E-5|                      5|                   8|            false|                 0.3692137|                0.27000406|                0.44481513|                 0.9401197|            -59.210976|              35.50291|            -35.727528|             -43.82059|          72| 331438.28520140756|     216.4026512492406|11.723763380492848|     NOT_AVAILABLE|202.19343244478654|-3.6652761741749558|94.76793891060406|  -15.5264915566589|\n|null|730-3072-1|1635378410781933568|3325280572393897728|      401324|   2015.0|93.72506279129922| 0.5853831056268157|7.620392962479164|  0.608571145147715|0.41385151308115636|0.36075034360415376|   -9.08223887222769| 2.731366083533451|  4.948450188963157|2.3587642281907355| -0.8325997|     -0.05539863|  -0.8725271|   0.85749245|      -0.16994305|   0.80997485|   -0.85905796|        0.23191138|        -0.18282288|     -0.9548213|                  98|                  98|                       98|                       91|                       0|                       7|               null|      0.9814247587687337|           599.9611034535313|                    true|                     9.564446|            1.0212107|          3.326191E-5|                      5|                  11|            false|                0.40113574|                0.32205975|                 0.5493878|                   0.91347|            -80.451706|              33.17572|            -30.543589|             -44.15794|          96|  346414.2502690981|     282.1718309011927|11.675780691173426|     NOT_AVAILABLE| 201.9573738404042| -4.563920499090119|93.83673839102143|-15.769289644642681|\n|null|730-2794-1|1635378410781933568|3325305964240545024|     1332550|   2015.0|93.81235167947963| 0.3430979947606009|7.899828518771204| 0.3983800990072072|  9.893074898046402| 0.3214119956253915|  11.212916705836646|1.5437843014622397| 13.877634439087831|1.3631537432730327| -0.6695651|     0.022861792|  -0.6047493|    0.5873298|       -0.4885334|    0.4864607|    -0.5639423|         0.1471853|         -0.1027421|    -0.93604386|                  61|                  61|                       59|                       60|                       2|                       1|               null|      0.5761399309481104|            395.675569640607|                    true|                     5.672817|            2.7096183|         2.0669444E-5|                      5|                   8|            false|                 0.5312338|                 0.6585292|                 0.5957727|                0.95965797|            -120.88964|             41.083252|            -24.431372|              43.25792|          67| 1815846.7142850081|    2480.7762120195607| 9.877072102538001|     NOT_AVAILABLE|201.75127559541306| -4.355725761089732|93.91863747559789|-15.487608974107744|\n|null|731-2933-1|1635378410781933568|3325335616694770816|      584772|   2015.0|94.01986601347079| 0.2290367137332313|8.141815546115529| 0.2953742894701604| 1.7724398795371377| 0.2753162817954013| -1.0787719301918208|0.9049683799323316| -3.180322501486486|0.8603696641258155|-0.51729643|      0.07186219|  -0.4635902|   0.41740718|       -0.5739662|   0.34610185|    -0.4719288|        0.12230089|       -0.068460636|    -0.86612177|                  69|                  69|                       69|                       68|                       0|                       1|               null|      0.4502891776482449|          200.86671144653116|                    true|                     4.477331|             4.282012|          2.448114E-5|                      5|                   9|            false|                 0.5322991|                 0.5012508|                 0.5837273|                0.96191615|           -110.209175|              41.77504|            -25.811083|              44.21676|          73|  1704107.401678639|    2591.4774370259215| 9.946027656885787|     NOT_AVAILABLE|201.63464770003782| -4.060340151953006|94.12458255631776|-15.239928872914092|\n|null| 732-886-1|1635378410781933568|3325392928740606720|     1674678|   2015.0|96.17253306241597|0.48462118228338086|7.766034768567088| 0.5465779101185164| 0.9054976643324829|0.34285939676086363|   5.243281913413511|2.6128406137120215|  8.200724747208158|2.3375055583841764|-0.80191153|     -0.15904057| -0.82798177|   0.80634797|     -0.028921233|    0.7820177|   -0.84113765|        0.36188427|        -0.32404923|    -0.95476985|                  88|                  88|                       87|                       80|                       1|                       8|               null|      0.8574261884047853|           910.3247755400103|                    true|                     8.370175|            1.3019437|          3.711215E-5|                      5|                  10|            false|                0.38079643|                0.38936776|                0.47846353|                0.92952347|            -84.223915|              38.62515|            -29.333904|             -43.73443|          87|    654766.63533472|    3583.2335857283533|10.984553710979776|     NOT_AVAILABLE| 202.9685658967809|-2.3536501276807797|96.34862259871927|-15.537318986857574|\n+----+----------+-------------------+-------------------+------------+---------+-----------------+-------------------+-----------------+-------------------+-------------------+-------------------+--------------------+------------------+-------------------+------------------+-----------+----------------+------------+-------------+-----------------+-------------+--------------+------------------+-------------------+---------------+--------------------+--------------------+-------------------------+-------------------------+------------------------+------------------------+-------------------+------------------------+----------------------------+------------------------+-----------------------------+---------------------+---------------------+-----------------------+--------------------+-----------------+--------------------------+--------------------------+--------------------------+--------------------------+----------------------+----------------------+----------------------+----------------------+------------+-------------------+----------------------+------------------+------------------+------------------+-------------------+-----------------+-------------------+\nonly showing top 20 rows\n\nimport spark.implicits._\nnewDataDF: org.apache.spark.sql.DataFrame = [hip: int, tycho2id: string ... 57 more fields]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271763_2054383414",
      "id": "20191124-174505_1328971246",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-29T12:43:04+0000",
      "dateFinished": "2019-11-29T12:43:04+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:317"
    },
    {
      "text": "%spark\nnewDataDF.explain",
      "user": "admin",
      "dateUpdated": "2019-11-29T12:43:14+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "== Physical Plan ==\n*(1) FileScan parquet [hip#2538,tycho2id#2539,solution_id#2540L,source_id#2541L,random_index#2542L,ref_epoch#2543,ra#2544,ra_error#2545,dec#2546,dec_error#2547,parallax#2548,parallax_error#2549,pmra#2550,pmra_error#2551,pmdec#2552,pmdec_error#2553,ra_dec_corr#2554,ra_parallax_corr#2555,ra_pmra_corr#2556,ra_pmdec_corr#2557,dec_parallax_corr#2558,dec_pmra_corr#2559,dec_pmdec_corr#2560,parallax_pmra_corr#2561,... 35 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://stv-aglais-master:9000/hadoop/gaia/parquet/gdr1/tgas/part-00000-85a0048f..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hip:int,tycho2id:string,solution_id:bigint,source_id:bigint,random_index:bigint,ref_epoch:...\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1575031345603_1348676552",
      "id": "20191129-124225_288450825",
      "dateCreated": "2019-11-29T12:42:25+0000",
      "dateStarted": "2019-11-29T12:43:14+0000",
      "dateFinished": "2019-11-29T12:43:15+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:318"
    },
    {
      "text": "%pyspark\n\n# remedian class\nclass Remedian():\n    '''\n    classdocs TODO\n    '''\n    \n    # fixed buffer size must always be an odd integer in this implementation\n    bufferSize = 11\n    \n    def __init__(self):\n        '''\n        Constructor.\n        '''\n        self.values = []\n        self.numInArray = []\n        self.numAccumulated = 0\n        self.addNewList()\n        self.merged = set()\n        \n    def add(self, value):\n        self.append(value, 0)\n        self.numAccumulated += 1\n    \n    def append(self, value, index):\n\n        # convenience references\n        array = self.values[index]\n        num = self.numInArray[index]\n\n        if num == self.bufferSize:\n            \n            # need to determine the median of this array\n            array.sort()\n            median = array[int(self.bufferSize / 2)]\n            \n            # create a new accumulation array if needed\n            if len(self.values) - 1 == index: self.addNewList()\n            \n            # and append to the next array accumulation\n            self.append(median, index + 1)\n            num = 0\n            self.numInArray[index] = num\n            \n        # finally add in the original new value\n        array[num] = value\n        self.numInArray[index] = num + 1\n    \n    def getMedian(self):\n        \n        # default if the method cannot return a valid resut\n        value = float(\"nan\")\n        \n        # get the lowest level array accumulation\n        array = self.values[-1]\n        n = self.numInArray[-1]\n        \n        # derive the median\n        if n == 1:\n            value = array[0]\n        elif n > 1:\n            # copy active elements and sort the array:\n            copy = array[0:n]\n            copy.sort()\n            if n % 2 == 0:\n                i = int(n/2) - 1\n                value = (copy[i] + copy[i + 1]) / 2.0\n            else:\n                value = copy[int(n / 2)]\n                \n        return value\n    \n    def addNewList(self):\n        \n        # append new list of buffer length\n        self.values.append([0.0] * self.bufferSize)\n        self.numInArray.append(0)\n    \n    def getNumberAccumulated(self):\n        return self.numAccumulated\n\n# create RDD of selected fields\n\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:56+0000",
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1574707271763_202139513",
      "id": "20191124-174543_727957289",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:56+0000",
      "dateFinished": "2019-11-25T18:41:56+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:319"
    },
    {
      "text": "%pyspark\n\n# utility generator function for the class in the previous paragraph\nfrom collections import defaultdict\n\ndef remedian(iterator):\n    \n    remedians = defaultdict(lambda: Remedian())\n    for k,v in iterator: remedians[k].add(v)\n        \n    yield [(k, remedian.getMedian()) for k, remedian in remedians.items()]",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:56+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1574707271764_-632294956",
      "id": "20191125-162301_93994030",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:56+0000",
      "dateFinished": "2019-11-25T18:41:56+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:320"
    },
    {
      "text": "%pyspark\n# create an RDD consisting of only the attributes required (sourceID, parallax_error)\nalldata = df.select('source_id', 'parallax_error').rdd\nprint ('Create new RDD with %d partitions' % (alldata.getNumPartitions()))\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:56+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Create new RDD with 6 partitions\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271764_1340305622",
      "id": "20191125-162351_965671179",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:56+0000",
      "dateFinished": "2019-11-25T18:41:56+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:321"
    },
    {
      "text": "%pyspark\n# map the data by HEALPix level 5\nhealpix_l5 = alldata.map(lambda x: [x[0] >> 49, x[1]]) \nhealpix_l5.take(10)",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:56+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[[5905, 0.4731823213382397], [5905, 0.3399542171903084], [5905, 0.36376163129282424], [5906, 0.26906257114112053], [5906, 0.24185736990362147], [5906, 0.7977808410302859], [5906, 0.43079831505623395], [5906, 0.23270868500434672], [5906, 0.2428117279030442], [5906, 0.24847509873158355]]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271764_531552559",
      "id": "20191125-163035_921117240",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:56+0000",
      "dateFinished": "2019-11-25T18:41:56+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:322"
    },
    {
      "text": "%pyspark\n# sanity check\nvalues_per_key = healpix_l5.map(lambda x: (x[0], 1)).reduceByKey(lambda a,b: a+b)\nprint(\"Number of unique keys: \",values_per_key.count())\nprint(values_per_key.sample(False, 0.001).collect())",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:41:57+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Number of unique keys:  12288\n[(1842, 110), (7669, 638), (5402, 517), (11534, 114), (12249, 59), (5128, 187), (3389, 267), (9929, 305), (9965, 533)]\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271764_-1601123285",
      "id": "20191125-163437_505432690",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:41:57+0000",
      "dateFinished": "2019-11-25T18:42:02+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:323"
    },
    {
      "text": "%pyspark\nresult = healpix_l5.mapPartitions(remedian).flatMap(lambda x: x).cache()\nresult.count()\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:42:02+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "70035\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271765_-1327659239",
      "id": "20191125-164018_1104727722",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:42:02+0000",
      "dateFinished": "2019-11-25T18:42:08+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:324"
    },
    {
      "text": "%pyspark\n# plot the results\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport healpy as hp\n\n# healpy constants\nNSIDE = 32\nNPIX = hp.nside2npix(NSIDE)\n\n# do the visualisation\narray_like = np.empty(NPIX)\nfor item in result.collect(): array_like[item[0]] = item[1]\nhp.mollview(array_like, nest=True, title=\"Median parallax uncertainty [mas]\")\nhp.graticule(coord=\"E\", color=\"white\")\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:42:08+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "0.0 180.0 -180.0 180.0\nThe interval between parallels is 30 deg -0.00'.\nThe interval between meridians is 30 deg -0.00'.\n"
          },
          {
            "type": "HTML",
            "data": ""
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1574707271765_853092254",
      "id": "20191125-164203_781266400",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:42:08+0000",
      "dateFinished": "2019-11-25T18:42:09+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:325"
    },
    {
      "text": "%pyspark\nimport healpy",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:42:09+0000",
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1574707271765_1042799871",
      "id": "20191125-165450_1744169208",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "dateStarted": "2019-11-25T18:42:09+0000",
      "dateFinished": "2019-11-25T18:42:09+0000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:326"
    },
    {
      "text": "%pyspark\n",
      "user": "admin",
      "dateUpdated": "2019-11-25T18:42:09+0000",
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1574707271765_-1473720279",
      "id": "20191125-182030_863068021",
      "dateCreated": "2019-11-25T18:41:11+0000",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 500,
      "$$hashKey": "object:327"
    }
  ],
  "name": "stv-example",
  "id": "2EUYPWE53",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {}
}
